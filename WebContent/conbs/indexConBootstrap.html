<!DOCTYPE html>
<html style="height: 95%;">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1"> 

<title>TySWeb 2015 (con BS)</title>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet" media="screen">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> 
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> 

</head>
<body style="height:100%;" onload="comprobarRecarga()">
	<div class="container">
		<div id="cabecera" class="row" style="background-color:lavender;">
			<div id="cabeceraTitulo" class="col-sm-2 col-md-2 col-lg-2">publianuncios.com</div>
			<div id="cabeceraBuscar" class="col-sm-5 col-md-5 col-lg-5">Buscar</div>
			<div id="cabeceraRegistro" class="col-sm-5 col-md-5 col-lg-5">
				<script>
					$("#cabeceraRegistro").load("FormDatosPersonales.html");
				</script>
			</div>
		</div>
		
		<div class="row">
		  	<div id="zonaCentroIzquierdaArbol" class="col-sm-2 col-md-2 col-lg-2">
			  	<ul id="ulCategorias">
				</ul>
		 	</div>
		  
		  <div id="zonaPrincipal" class="col-sm-10 col-md-10 col-lg-10">
		  	<div class="row">
		  		<div class="col-sm-12 col-md-12 col-lg-12">
		  			Estás en Tal -> Cual
		  		</div>
		  	</div>
		  	<div class="row">
		  		<div class="col-sm-2 col-md-2 col-lg-2">
		  			<label>Filtrar por:</label>		  			
		  		</div>
		  		<div class="col-sm-4 col-md-4 col-lg-4">
		  			<label for="ccaa">Comunidad autónoma:</label>
					<select id="ccaa" onchange="loadProvincias()">
						<option></option>
					</select>		
		  		</div>
		  		<div class="col-sm-3 col-md-3 col-lg-3">
		  			<label for="provincias">Provincia:</label>
					<select id="provincias" onchange="loadMunicipios()">
					</select>		
		  		</div>
		  		<div class="col-sm-3 col-md-3 col-lg-3">
		  			<label for="municipios">Municipio:</label>
					<select id="municipios">
					</select>
		  		</div> 
		  	</div>
		  	<div class="row">
		  		<div class="col-sm-12 col-md-12 col-lg-12">
		  			Fotos
		  		</div>
		  	</div>
		  </div>
		</div>
		
		<div class="row" style="background-color:lavenderblush">
		  <div class="col-sm-3 col-md-3 col-lg-3">
		  	<a href="terminosDeUso.html">Términos de uso</a>
		  </div>
		  <div class="col-sm-3 col-md-3 col-lg-3">Política de cookies</div>
		  <div class="col-sm-3 col-md-3 col-lg-3">Quiénes somos</div>
		  <div class="col-sm-3 col-md-3 col-lg-3">Contacto</div>
		</div>
	</div>
	
		<script>
	
	/** Carga de comunidades autónomas **/
	var selectCCAA=document.getElementById("ccaa");
	var selectProvincias=document.getElementById("provincias");
	var selectMunicipios=document.getElementById("municipios");
	
	var request = new XMLHttpRequest();	
	request.open("post", "../jsp/getCCAA.jsp");
	request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
	request.onreadystatechange=function() {
		if (request.readyState==4) {
			if (request.status==200) {
				var ccaa=JSON.parse(request.responseText);
				for (var i=0; i<ccaa.length; i++) {
					var ca=ccaa[i];
					var optionCA=document.createElement("option");
					optionCA.setAttribute("value", ca.id);
					optionCA.innerHTML=ca.nombre;
					selectCCAA.appendChild(optionCA);
				}
			} else {
				alert(request.status);
			}
		}
	};
	request.send();
	
	/** Carga de provincias **/
	function loadProvincias() {
		request = new XMLHttpRequest();	
		request.open("post", "../jsp/getProvincias.jsp");
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		request.onreadystatechange=function() {
			if (request.readyState==4 && request.status==200) {
				selectProvincias.options.length=0;
				selectProvincias.appendChild(document.createElement("option"));
				var provincias=JSON.parse(request.responseText);
				for (var i=0; i<provincias.length; i++) {
					var provincia=provincias[i];
					var optionProvincia=document.createElement("option");
					optionProvincia.setAttribute("value", provincia.id);
					optionProvincia.innerHTML=provincia.nombre;
					selectProvincias.appendChild(optionProvincia);
				}
			}
		};
		var pars="ca=" + selectCCAA.value;
		request.send(pars);
	}
	
	/** Carga de municipios **/
	function loadMunicipios() {
		request = new XMLHttpRequest();	
		request.open("post", "../jsp/getMunicipios.jsp");
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		request.onreadystatechange=function() {
			if (request.readyState==4 && request.status==200) {
				selectMunicipios.options.length=0;
				var municipios=JSON.parse(request.responseText);
				for (var i=0; i<municipios.length; i++) {
					var municipio=municipios[i];
					var optionMunicipio=document.createElement("option");
					optionMunicipio.setAttribute("value", municipio.id);
					optionMunicipio.innerHTML=municipio.nombre;
					selectMunicipios.appendChild(optionMunicipio);
				}
			}
		};
		var pars="provincia=" + selectProvincias.value;
		request.send(pars);
	}
	</script>
	
	<script src="scripts/productos.js"></script>
	<script src="scripts/gestionCuentas.js"></script>
	<script src="scripts/menuUsuario.js"></script>
</body>
</html>